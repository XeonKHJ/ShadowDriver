#pragma once
#include <fwpsk.h>
#include <fwpmk.h>

#define SHADOWDRIVER_IOCTL_START_WFP                    CTL_CODE(FILE_DEVICE_NETWORK, 0x909, METHOD_IN_DIRECT, FILE_READ_DATA | FILE_WRITE_DATA)
#define SHADOWDRIVER_IOCTL_REQUIRE_PACKET_INFO          CTL_CODE(FILE_DEVICE_NETWORK, 0x910, METHOD_IN_DIRECT, FILE_ANY_ACCESS)
#define SHADOWDRIVER_IOCTL_REQUIRE_PACKET_INFO_SHIT     CTL_CODE(FILE_DEVICE_NETWORK, 0x911, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define SHADOWDRIVER_IOCTL_REQUIRE_VERSION_INFO         CTL_CODE(FILE_DEVICE_NETWORK, 0x901, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define SHADOWDRIVER_IOCTL_INVERT_NOTIFICATION          CTL_CODE(FILE_DEVICE_NETWORK, 0x921, METHOD_BUFFERED, FILE_ANY_ACCESS)
#define SHADOWDRIVER_IOCTL_GET_DRIVER_VERSION           CTL_CODE(FILE_DEVICE_NETWORK, 0x922, METHOD_BUFFERED, FILE_ANY_ACCESS)

static const GUID calloutsGuid = { 0xc21d8417, 0xf64e, 0x4669, { 0xa0, 0x95, 0x1d, 0xeb, 0x48, 0xad, 0xd1, 0x17 } };
DEFINE_GUID(SHADOWDRIVER_WFP_SEND_ESTABLISHED_CALLOUT_GUID, 0xc21d8417, 0xf64e, 0x4669, 0xa0, 0x95, 0x1d, 0xeb, 0x48, 0xad, 0xd1, 0x17);
DEFINE_GUID(SHADOWDRIVER_WFP_RECEIVE_ESTABLISHED_CALLOUT_GUID, 0x2f2f004c, 0xf40d, 0x46f5, 0x91, 0xa6, 0x80, 0xb7, 0x65, 0xc7, 0x84, 0xe0);
DEFINE_GUID(SHADOWDRIVER_WFP_SUBLAYER_GUID, 0x86e8c72a, 0xebc, 0x4b60, 0xa4, 0xf6, 0x3d, 0xc4, 0x1b, 0x52, 0xae, 0x3e);